{% extends "base.html" %}


{% block main %}

<div class="collection-detail">
    <h1>{{ collection.name }}</h1>
</div>

<div class="posts-list">
    {% for post in posts %}
        <div class="post-card">
            <a href="{{ post.get_absolute_url }}">
                {% if post.get_first_image %}
                    <img src="{{ post.get_first_image }}" alt="Post image">
                {% else %}
                    <img src="https://dom-dekor.ru/images/not-photo.png.webp" alt="Post image">
                {% endif %}
            </a>

            <h2><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>
            <p>{{ post.description|truncatechars:100 }}</p>

            <div class="post-info">
                <span>–ê–≤—Ç–æ—Ä: {{ post.user.username }}</span>
                <div class="reactions">
                    <button class="like-btn">‚ù§Ô∏è {{ post.get_likes_count }}</button>
                    <button class="dislike-btn">üëé {{ post.get_dislikes_count }}</button>
                </div>
            </div>

            <div class="tags">
                {% for tag in post.tags.all %}
                    <span>#{{ tag.title }}</span>
                {% endfor %}
            </div>

            <div class="actions">
                {% if user.is_authenticated %}
                    {% if collections %}
                        <form action="{% url 'add_to_collection' post.id %}" method="post">
                            {% csrf_token %}
                            {{ collection_form.as_p }}
                            <input type="hidden" name="next" value="{{ request.path }}">
                            <button type="submit" class="add-collection-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
                        </form>
                    {% else %}
                        <a href="{% url 'collection_create' %}" class="add-collection-btn">‚ûï –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</a>
                    {% endif %}
                {% else %}
                    <a href="{% url 'collection_create' %}" class="add-collection-btn">‚ûï –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</a>
                {% endif %}
            </div>
        </div>
    {% empty %}
        <p>–í —ç—Ç–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤.</p>
    {% endfor %}
</div>

{% endblock main %}




